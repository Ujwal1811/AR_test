<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Motorev AR Viewer</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@3.3.2/aframe/build/aframe-ar.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
        }
        .data-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            padding: 10px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            color: orange;
            font-family: Arial;
            z-index: 100;
        }
        .marker-hint {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="data-panel">
        <div>Voltage: <span id="voltage">46.7 V</span></div>
        <div>Current: <span id="current">0.6 A</span></div>
        <div>Temp: <span id="temperature">93.7 °C</span></div>
        <div>SOC: <span id="soc">85.6 %</span></div>
        <div>SOH: <span id="soh">95.3 %</span></div>
        <div>Speed: <span id="speed">0.1 km/h</span></div>
        <div>Range: <span id="range">81.0 km</span></div>
        <div>Status: <span id="status">Connected</span></div>
    </div>

    <div class="marker-hint" id="hint">Point camera at Hiro marker</div>

    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false;"
        renderer="logarithmicDepthBuffer: true;"
    >
        <!-- Main marker with 3D model -->
        <a-marker preset="hiro">
            <a-entity 
                gltf-model="url(motorev.glb)"
                scale="0.1 0.1 0.1"
                position="0 0 0"
            ></a-entity>
        </a-marker>
        
        <!-- Fallback primitive (visible if model fails) -->
        <a-marker preset="hiro">
            <a-box position="0 0.5 0" color="red" scale="0.5 0.5 0.5"></a-box>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Update data values
        function updateData() {
            const elements = {
                voltage: { min: 46, max: 48, unit: 'V' },
                current: { min: 0.4, max: 0.7, unit: 'A' },
                temperature: { min: 90, max: 95, unit: '°C' },
                soc: { min: 80, max: 90, unit: '%' },
                soh: { min: 95, max: 97, unit: '%' },
                speed: { min: 0, max: 0.2, unit: 'km/h' },
                range: { min: 80, max: 85, unit: 'km' }
            };

            Object.entries(elements).forEach(([id, config]) => {
                const value = (Math.random() * (config.max - config.min) + config.min).toFixed(1);
                document.getElementById(id).textContent = `${value} ${config.unit}`;
            });
        }

        // Handle marker detection
        const scene = document.querySelector('a-scene');
        scene.addEventListener('markerFound', () => {
            document.getElementById('hint').style.display = 'none';
            document.getElementById('status').textContent = "Marker Found";
        });

        scene.addEventListener('markerLost', () => {
            document.getElementById('hint').style.display = 'block';
            document.getElementById('status').textContent = "Scanning...";
        });

        // Initial data update
        updateData();
        setInterval(updateData, 1500);
    </script>
</body>
</html>
